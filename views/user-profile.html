<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
       <meta charset="utf-8">
       <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
       <!-- Bootstrap CSS -->
       <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> 
       <link rel="stylesheet" href="/css/style.css">
       <link rel="stylesheet" href="/css/result-page.css">
       <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=bookmark" />
       <script src="https://kit.fontawesome.com/d7379cf77c.js" crossorigin="anonymous"></script>
       <title>Profile</title>
   </head>
<body>
    <!-- ---------------------------------------------------------HEADER------------------------------------------------------- -->
    <!-- <div id="overlay"></div>
    <header class="fixed-top">
        <nav class="navbar navbar-expand-lg">
            <a class="navbar-brand" href="/">
                <img src="/images/logo2.png" width="150px" height="33px">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <div class="col-6">
                    <ul class="navbar-nav">
                        <li class="nav-item active">
                            <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
                        </li>
                      
                        <li class="nav-item">
                            <a class="nav-link" href="/suggestion">Suggestion</a>
                            </li> 
                        </ul>
                </div>
                <div class="col-4 d-flex justify-content-end pr-2 ml-3">
                  <div class="search-container">
                      <div class="search-box">
                          <img src="/images/icon/search-icon.png" alt="Search" class="search-icon">
                          <input type="text" class="search-input" placeholder="Search for a movie..."
                              onkeyup="searchMovies(this.value)" onfocus="showResults()">
                      </div>
                      <div class="search-results" id="searchResults"></div>
                  </div>
              </div>
                <div class="col-1 d-flex ">
                    <ul class="menu-right">
                        <li class="nav-item dropdown">
                            <button class="nav-link dropbtn">
                                <img src="/images/icon/user-fill.png" class="icon-green" />
                                <span class="main-font "><%= loggedIN %></span>
                                <img src="/images/icon/drop-more.png" class="icon-green" />
                            </button>
                            <ul class="dropdown-content">
                                <li class="nav-item">
                                    <a class="nav-link" href="/user-profile">
                                        <img src="/images/icon/edit-profile.png" class="img-icon" />
                                        Edit Profile
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/logout">
                                        <img src="/images/icon/sign-out.png" class="img-icon" />
                                        Sign out
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>             
            </div>
        </nav>
    </header> -->


    <!----- Section - header ----->
   <!-- Profile Display (Uneditable) -->
   <div id="overlay"></div>
   <header class="fixed-top">
       <nav class="navbar navbar-expand-lg">
           <a class="navbar-brand" href="/">
               <img src="/images/logo2.png" width="150px" height="33px">
           </a>
           <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
             <span class="navbar-toggler-icon"></span>
           </button>
         
           <div class="collapse navbar-collapse" id="navbarSupportedContent">
               <div class="col-6">
                   <ul class="navbar-nav">
                       <li class="nav-item active">
                           <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
                       </li>
                     
                       <li class="nav-item">
                           <a class="nav-link" href="/suggestion">Suggestion</a>
                           </li> 
                       </ul>
               </div>
               <div class="col-4 d-flex justify-content-end pr-2 ml-3">
                <div class="search-container">
                    <div class="search-box">
                        <img src="/images/icon/search-icon.png" alt="Search" class="search-icon">
                        <input type="text" class="search-input" placeholder="Search for a movie..."
                            onkeyup="searchMovies(this.value)" onfocus="showResults()">
                    </div>
                    <div class="search-results" id="searchResults"></div>
                </div>
            </div>
               <div class="col-1 d-flex ">
                   <ul class="menu-right">
                       <li class="nav-item dropdown">
                           <button class="nav-link dropbtn">
                               <img src="/images/icon/user-fill.png" class="icon-green" />
                               <span class="main-font "><%= loggedIN %></span>
                               <img src="/images/icon/drop-more.png" class="icon-green" />
                           </button>
                           <ul class="dropdown-content">
                               <li class="nav-item">
                                   <a class="nav-link" href="/user-profile">
                                       <img src="/images/icon/edit-profile.png" class="img-icon" />
                                       Edit Profile
                                   </a>
                               </li>
                               <li class="nav-item">
                                   <a class="nav-link" href="/logout">
                                       <img src="/images/icon/sign-out.png" class="img-icon" />
                                       Sign out
                                   </a>
                               </li>
                           </ul>
                       </li>
                   </ul>
               </div>             
           </div>
       </nav>
   </header>


   <!----- Section - header ----->
  <!-- Profile Display (Uneditable) -->
  <div class="container user-box">
   <div class="profile-card">
       <div class="profile-header">
           <img class="user-pic" src="/images/user1-id.png" alt="User Image">
           <h2 class="user-name"><%= loggedIN %></h2>
       </div>


               <div class="profile-info">
                   <p><strong class="label">Email:</strong> <span><%= email %></span></p>
                   <p><strong class="label">Birthday:</strong> <span><%= new Date(date).toLocaleDateString() %></span></p>
                   <p><strong class="label">Gender:</strong> <span><%= gender %></span></p>
               </div>
               

           <button class="btn s-button" id="editProfileBtn">EDIT PROFILE</button>
           <button class="btn s-button" id="changePasswordBtn">CHANGE PASSWORD</button>

     
   </div>
</div>
<!-- Edit Profile Form -->
<div class="container hidden" id="editProfileFormContainer">
   <form id="editProfileForm">
       <h3>Edit Profile</h3>

       <label>Username</label>
       <input type="text" id="username" value="<%= loggedIN %>" disabled>

       <label>Email</label>
       <input type="email" id="email" value="<%= email %>" disabled>

       <label>Gender</label>
       <select id="gender" disabled>
           <option value="Male" <%= gender === "Male" ? "selected" : "" %>>Male</option>
           <option value="Female" <%= gender === "Female" ? "selected" : "" %>>Female</option>
           <option value="Other" <%= gender === "Other" ? "selected" : "" %>>Other</option>
       </select>

       <button type="button" class="btn s-button" id="editBtn">Edit</button>
       <button type="submit" class="btn s-button hidden" id="saveBtn">Save</button>
   </form>
</div>
<!-- Change Password Form -->
<!-- Change Password Form -->
<div class="container hidden" id="passwordSection">
   <form id="changePasswordForm">
       <h3>Change Password</h3>

       <label>New Password</label>
       <div class="input-wrapper">
           <input type="password" id="newPassword" required>
           <span class="toggle-password" onclick="togglePassword">
               <i class="fa-regular fa-eye-slash"></i>
           </span>
       </div>

       <label>Confirm Password</label>
       <div class="input-wrapper">
           <input type="password" id="confirmPassword" required>
           <span class="toggle-password" onclick="togglePassword">
               <i class="fa-regular fa-eye-slash"></i>
           </span>
       </div>

       <p id="passwordError" class="alert alert-danger hidden">Passwords do not match!</p>

       <button class="btn s-button" type="button" id="requestOtpBtn">Request OTP</button>

       <div id="otpSection" class="hidden">
           <label>Enter OTP</label>
           <input type="text" id="otpCode" required>
           <button class="btn s-button" type="button" id="submitPasswordBtn">Submit</button>
       </div>
   </form>
</div>

    <!----- Section - Info ----->

    <div class="user-info">
       
        <div class="history-box">
            <!----- Section - Info ----->

<div class="container">
    <!-- 🟡 Section: Wishlist -->
    <div class="history-topic">
        <div class="topic-header">
          <div class="circle-button">
            <span class="star">&#9733;</span>
          </div>
          <div class="title-font main-font">Wishlist</div>
        </div>
        <div class="row mx-5">
          <% wishlist.forEach(movie => { %>
            <div class="title-item">
              <a href="/movie-detail?id=<%= movie._id %>" class="title-item-link">
                <figure>
                  <img class="poster-top" src="<%= movie.poster_url?.[0] || '/images/default-poster.jpg' %>" alt="<%= movie.title %>">
                </figure>
                <div class="poster-title-box">
                  <div class="top-title">
                    <span class="entry-title"><%= movie.title %> (<%= movie.year %>)</span>
                  </div>
                </div>
              </a>
            </div>
          <% }) %>
        </div>
      </div>
      

    <!-- 💚 Section: Like -->
<!-- 💚 Section: Like -->
<% if (like && like.length > 0) { %>
    <div class="history-topic">
      <div class="topic-header">
        <div class="circle-button">
          <span class="star">&#9733;</span>
        </div>
        <div class="title-font main-font">Liked</div>
      </div>
      <div class="row mx-5">
        <% like.forEach(movie => { %>
          <div class="title-item">
            <a href="/movie-detail?id=<%= movie._id %>" class="title-item-link">
              <figure>
                <img class="poster-top" src="<%= movie.poster_url?.[0] || '/images/default-poster.jpg' %>" alt="<%= movie.title %>">
              </figure>
              <div class="poster-title-box">
                <div class="top-title">
                  <span class="entry-title"><%= movie.title %> (<%= movie.year %>)</span>
                </div>
              </div>
            </a>
          </div>
        <% }) %>
      </div>
    </div>
  <% } %>
  

    <!-- ❤️ Section: Dislike -->
<!-- ❤️ Section: Dislike -->
<% if (dislike && dislike.length > 0) { %>
    <div class="history-topic">
      <div class="topic-header">
        <div class="circle-button">
          <span class="star">&#9733;</span>
        </div>
        <div class="title-font main-font">Disliked</div>
      </div>
      <div class="row mx-5">
        <% dislike.forEach(movie => { %>
          <div class="title-item">
            <a href="/movie-detail?id=<%= movie._id %>" class="title-item-link">
              <figure>
                <img class="poster-top" src="<%= movie.poster_url?.[0] || '/images/default-poster.jpg' %>" alt="<%= movie.title %>">
              </figure>
              <div class="poster-title-box">
                <div class="top-title">
                  <span class="entry-title"><%= movie.title %> (<%= movie.year %>)</span>
                </div>
              </div>
            </a>
          </div>
        <% }) %>
      </div>
    </div>
  <% } %>
  

<!-- 👁️ Section: Seen -->
<% if (seen && seen.length > 0) { %>
    <div class="history-topic">
      <div class="topic-header">
        <div class="circle-button">
          <span class="star">&#9733;</span>
        </div>
        <div class="title-font main-font">Seen</div>
      </div>
      <div class="row mx-5">
        <% seen.forEach(movie => { %>
          <div class="title-item">
            <a href="/movie-detail?id=<%= movie._id %>" class="title-item-link">
              <figure>
                <img class="poster-top" src="<%= movie.poster_url?.[0] || '/images/default-poster.jpg' %>" alt="<%= movie.title %>">
              </figure>
              <div class="poster-title-box">
                <div class="top-title">
                  <span class="entry-title"><%= movie.title %> (<%= movie.year %>)</span>
                </div>
              </div>
            </a>
          </div>
        <% }) %>
      </div>
    </div>
  <% } %>
  
</div>

                       
        </div>
    </div>



    
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.1/gsap.min.js"></script>
    <script src="/js/editprofile.js"></script>
    <script src="/js/togglepassword.js"></script>
    <script src="/js/search.js"></script>
    
</body>
</html>